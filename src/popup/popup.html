<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Job Evaluator for LinkedIn (Free)</title>
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div class="popup">
    <header class="header">
      <h1 class="title">AI Job Evaluator <span id="versionDisplay" class="version" aria-label="Extension version"></span></h1>
      <div class="header-actions">
        <button type="button" class="tab-link" data-tab="settings" aria-label="Open settings">Settings</button>
        <button type="button" class="tab-link" data-tab="resumes" aria-label="Manage resumes">Resumes</button>
        <button type="button" class="tab-link" data-tab="debug" aria-label="Debug log">Debug</button>
        <a href="https://github.com/akki166786/job-evaluator/blob/main/README.md" target="_blank" rel="noopener noreferrer" class="help-link" id="helpLink" aria-label="Help / More info">ℹ️ Help</a>
      </div>
    </header>

    <section id="panel-main" class="panel active">
      <p class="hint resume-hint" id="resumeHint">Select resumes to include. If none selected, only your profile intent, skills/tech stack, and negative filters are sent.</p>
      <div id="resumeCheckboxes" class="resume-checkboxes"></div>
      <div class="eval-section">
        <p id="evalHint" class="hint">Open a LinkedIn job page to evaluate.</p>
      </div>
      <div id="cacheWrap" class="cache-wrap hidden">
        <p id="cacheText" class="hint"></p>
        <div class="cache-actions">
          <button type="button" id="useCacheBtn" class="btn btn-secondary" aria-label="Use previously cached evaluation score">Use cached score</button>
          <button type="button" id="rerunBtn" class="btn btn-primary" aria-label="Re-evaluate this job">Re-evaluate</button>
        </div>
      </div>
      <div id="resultWrap" class="result-wrap hidden">
        <div id="resultContent" class="result-content"></div>
        <div id="resultActions" class="result-actions hidden">
          <button type="button" id="recalculateBtn" class="btn btn-secondary" aria-label="Re-evaluate this job">Recalculate</button>
        </div>
        <details id="resultRaw" class="result-raw hidden">
          <summary>Raw response</summary>
          <pre id="resultRawText"></pre>
        </details>
      </div>
      <div id="loadingWrap" class="loading-wrap hidden">
        <div class="loading-spinner" aria-hidden="true"></div>
        <div class="loading-content">
          <span class="loading-title">Evaluating job fit</span>
          <span class="loading-dots" aria-hidden="true"><span>.</span><span>.</span><span>.</span></span>
        </div>
        <p class="loading-hint" id="loadingHint">Waiting for model reply…</p>
      </div>
      <div id="errorWrap" class="error-wrap hidden"><p id="errorText" class="error"></p></div>
      <div id="markBadWrap" class="mark-bad-wrap">
        <label class="label">Mark current job as bad</label>
        <input type="text" id="markBadComment" class="input" placeholder="Reason (e.g. wrong location, no remote)" maxlength="500" />
        <button type="button" id="markBadBtn" class="btn btn-secondary">Mark as bad</button>
      </div>
      <div id="processingJobsWrap" class="processing-jobs-wrap">
        <div class="processing-jobs-title">Processing jobs</div>
        <div id="processingJobsList" class="processing-jobs-list"></div>
      </div>
    </section>

    <section id="panel-settings" class="panel">
      <label class="label">Profile & role intent</label>
      <textarea id="profileIntent" class="textarea" rows="4" placeholder="Who you are, what roles you target, preferred companies/locations…"></textarea>
      <label class="label">Skills / tech stack</label>
      <textarea id="skillsTechStack" class="textarea" rows="3" placeholder="e.g. React, Next.js, Node.js, TypeScript, Python"></textarea>
      <label class="label">Negative filters (deal-breakers)</label>
      <textarea id="negativeFilters" class="textarea" rows="3" placeholder="What you are NOT looking for (e.g. Java-only, on-site only, fluent Dutch)"></textarea>
      <label class="label">Provider</label>
      <select id="apiProvider" class="select">
        <option value="ollama">Ollama (local)</option>
        <option value="groq">Groq</option>
        <option value="google">Google (Gemini)</option>
        <option value="openai">OpenAI</option>
        <option value="anthropic">Anthropic</option>
        <option value="openrouter">OpenRouter</option>
      </select>
      <div id="modelWrap" class="api-key-wrap">
        <label class="label" id="modelLabel">Model (optional)</label>
        <input type="text" id="modelInput" class="input" placeholder="Default model" aria-labelledby="modelLabel" />
      </div>
      <div id="apiKeyWrap" class="api-key-wrap hidden">
        <label class="label" id="apiKeyLabel">API key</label>
        <input type="password" id="apiKey" class="input" placeholder="Your API key" autocomplete="off" aria-labelledby="apiKeyLabel" />
      </div>
      <button type="button" id="saveSettings" class="btn btn-secondary" aria-label="Save settings">Save settings</button>
      <button type="button" class="tab-link back" data-tab="main" aria-label="Back to main panel">Back</button>
    </section>

    <section id="panel-resumes" class="panel">
      <p class="hint">Add up to 5 resumes (PDF or DOCX). Label each (e.g. Frontend, Full-stack).</p>
      <div id="addResumeWrap" class="add-resume">
        <input type="text" id="resumeLabel" class="input inline-label" placeholder="Label (e.g. Frontend)" maxlength="50" />
        <input type="file" id="resumeFile" class="file-input" accept=".pdf,.docx" />
        <button type="button" id="addResume" class="btn btn-secondary" aria-label="Add resume">Add resume</button>
      </div>
      <div id="resumeLoading" class="resume-upload-state resume-loading hidden" role="status">
        <span class="resume-loading-spinner" aria-hidden="true"></span>
        <span id="resumeLoadingText">Parsing…</span>
      </div>
      <div id="resumeResultsWrap" class="resume-upload-state resume-results hidden">
        <h3 class="resume-results-title">Processing results</h3>
        <div class="resume-results-meta">
          <span id="resumeResultsMeta"></span>
        </div>
        <p id="resumeResultsPreview" class="resume-results-preview"></p>
        <p class="resume-results-hint">This text will be sent to the model when you evaluate a job.</p>
        <button type="button" id="resumeSaveBtn" class="btn btn-primary resume-save-btn">Save CV</button>
      </div>
      <p class="label resume-list-label">Your resumes</p>
      <div id="resumeList" class="resume-list"></div>
      <p id="resumeError" class="error hidden" role="alert"></p>
      <button type="button" class="tab-link back" data-tab="main" aria-label="Back to main panel">Back</button>
    </section>

    <section id="panel-debug" class="panel">
      <div class="debug-toolbar">
        <span class="debug-title">Debug log</span>
        <button type="button" id="debugClear" class="btn btn-secondary btn-small">Clear</button>
      </div>
      <div id="debugLog" class="debug-log" role="log"></div>
      <button type="button" class="tab-link back" data-tab="main" aria-label="Back to main panel">Back</button>
    </section>

    <footer class="popup-footer">
      <a href="https://buymeacoffee.com/coachakshaytiwari" target="_blank" rel="noopener noreferrer" class="support-link" aria-label="Support on Buy Me a Coffee">
        <span class="support-link-icon" aria-hidden="true">☕</span>
        <span>Buy me a coffee</span>
      </a>
    </footer>
  </div>
  <script src="popup.js"></script>
</body>
</html>
